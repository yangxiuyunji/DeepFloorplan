# 厨房识别功能说明文档

## 🍳 功能概述

本系统现在支持单独识别厨房区域，可以将厨房从原本的"客厅/厨房/餐厅"混合类别中分离出来，实现更精确的户型图解析。

## 🎯 实现方法

### 1. 颜色编码更新
- **厨房类别**: 7 - RGB(255, 200, 100) 橙黄色
- **客厅/餐厅类别**: 3 - RGB(224, 255, 192) 浅绿色

### 2. OCR文字识别增强
支持识别以下厨房相关文字：
- **中文**: 厨房、烹饪
- **英文**: kitchen, cook

### 3. 空间分析算法
当OCR无法明确识别时，系统会使用以下启发式规则：
- **面积分析**: 厨房通常比客厅面积小
- **形状分析**: 厨房多为矩形，长宽比例相对规整
- **密度分析**: 厨房空间利用率通常较高

## 🚀 使用方法

### 基本使用
```bash
# 激活虚拟环境
.\dfp\Scripts\Activate.ps1

# 运行厨房识别
python demo.py --im_path=./demo/45765448.jpg
```

### 参数说明
- `--im_path`: 指定要分析的户型图路径
- `--disable_closet`: 可选，禁用衣柜识别

### 测试脚本
```bash
# 运行专门的厨房识别测试
python test_kitchen.py
```

## 🔧 技术细节

### 代码模块
1. **color_guide.py**: 更新了颜色映射，为厨房分配了新的类别ID(7)
2. **utils/ocr.py**: 扩展了文字识别映射，厨房相关文字映射到类别7
3. **demo.py**: 新增`enhance_kitchen_detection()`函数，实现厨房检测增强

### 处理流程
```
原始图像 → 神经网络分割 → OCR文字识别 → 厨房检测增强 → 最终结果
```

### 依赖包
- tensorflow==2.13.0
- numpy<2.0 (兼容性要求)
- scipy>=1.0.0 (用于连通域分析)
- pytesseract>=0.3.0 (OCR功能)

## 📊 识别效果

### 成功案例
- ✅ 有明确"厨房"文字标注的户型图
- ✅ 厨房区域与客厅明显分离的布局
- ✅ 规整矩形厨房空间

### 局限性
- ⚠️ 开放式厨房可能难以准确分离
- ⚠️ 无文字标注且形状不规则的厨房识别准确率较低
- ⚠️ 极小或极大的厨房空间可能被误判

## 🎨 可视化效果

运行demo后会显示两个窗口：
- **左图**: 原始户型图
- **右图**: AI识别结果
  - 橙黄色区域 = 厨房
  - 浅绿色区域 = 客厅/餐厅
  - 其他颜色对应不同房间类型

## 🔮 后续优化方向

1. **深度学习模型**: 训练专门的厨房识别分支
2. **家具识别**: 通过识别厨房设备(橱柜、灶台等)来辅助判断
3. **布局分析**: 基于更复杂的空间关系进行推理
4. **用户反馈**: 支持用户手动标注来改进算法

## 🤝 使用建议

1. **图像质量**: 使用清晰、高分辨率的户型图效果更好
2. **文字标注**: 有中文或英文房间标注的图片识别准确率更高
3. **标准布局**: 传统分离式厨房比开放式厨房更容易识别
4. **多次测试**: 对于重要项目，建议使用多张相似图片验证结果

---

💡 **提示**: 如果发现识别效果不理想，可以尝试调整`enhance_kitchen_detection()`函数中的启发式参数。
